#!/bin/bash

echo "Switching to Nginx setup..."

# Stop current setup
docker-compose down 2>/dev/null || true

# Start Nginx setup
docker-compose -f docker-compose.nginx.yml up -d

echo "Nginx setup started!"
echo "Test URL: http://php.nginx.localhost/api/stress-test"
echo "Logs: ./logs/nginx/"

# Wait for services
echo "Waiting for services to be ready..."
sleep 10

# Health check
if curl -s http://localhost/health > /dev/null; then
    echo "✅ Nginx is healthy and ready for testing!"
else
    echo "❌ Nginx health check failed"
fi